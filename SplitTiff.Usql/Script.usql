REFERENCE ASSEMBLY [BitMiracle.LibTiff.NET40];
REFERENCE ASSEMBLY SplitTiff;

@tiff_images =
    EXTRACT chunkId int, tiff byte[], size int, name string
    FROM "/tiff_inputs/{name}.tif"
    USING new SplitTiff.SplitTiffExtractor(1000, 1000);

OUTPUT @tiff_images
TO "/tiff_outputs/out_{*}.tif"
USING new SplitTiff.TiffOutputter();

@result = 
    SELECT chunkId, size, name
    FROM @tiff_images;

OUTPUT @result
TO "/tiff_outputs/splits.csv"
USING Outputters.Csv();